
  {% for emp_data in report %}
<div class="row g-4 mb-4">
  <div class="col-12">
    <div class="card-body p-3">
      <div class="row g-0 text-center">

        <!-- Heures totales -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-primary rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-clock-history text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Heures totales</h5>
            <h2 class="mb-0 fw-bold">{{ emp_data.totals.hours|floatformat:2 }}h</h2>
          </div>
        </div>

        <!-- Heures supp. journalières -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-success rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-alarm text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Heures supp.</h5>
            <h2 class="mb-0 fw-bold">{{ emp_data.totals.regular_overtime|floatformat:2 }}h</h2>
          </div>
        </div>

        <!-- Retards cumulés (en minutes) -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-warning rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-exclamation-triangle text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Retards</h5>
            <h2 class="mb-0 fw-bold">
              {{ emp_data.totals.late|default:0|floatformat:0 }} min
            </h2>
          </div>
        </div>

        <!-- Départs anticipés cumulés (en minutes) -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-info rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-clock text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Départs anticipés</h5>
            <h2 class="mb-0 fw-bold">
              {{ emp_data.totals.early_leave|default:0|floatformat:0 }} min
            </h2>
          </div>
        </div>

        <!-- Absences -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-danger rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-x-circle text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Absences</h5>
            <h2 class="mb-0 fw-bold">{{ emp_data.totals.absence }}</h2>
          </div>
        </div>

        <!-- Salaire régulier -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-primary rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-cash text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Salaire régulier</h5>
            <h2 class="mb-0 fw-bold">{{ emp_data.totals.regular_salary|floatformat:2 }} €</h2>
          </div>
        </div>

        <!-- Salaire Heures supp. -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-success rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-clock text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Salaire supp.</h5>
            <h2 class="mb-0 fw-bold">{{ emp_data.totals.regular_overtime_salary|floatformat:2 }} €</h2>
          </div>
        </div>

        <!-- Salaire total -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-info rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-wallet2 text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Salaire total</h5>
            <h2 class="mb-0 fw-bold">{{ emp_data.totals.total_salary|floatformat:2 }} €</h2>
          </div>
        </div>

        <!-- Taux horaire -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-secondary rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-speedometer2 text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Taux horaire</h5>
            <h2 class="mb-0 fw-bold">{{ emp_data.totals.hourly_rate|floatformat:2 }} €</h2>
          </div>
        </div>

        <!-- Heures attendues -->
        <div class="col-md-2 p-2">
          <div class="p-3">
            <div class="bg-dark rounded-circle mx-auto mb-3" style="width:60px; height:60px;">
              <i class="bi bi-file-earmark-text text-white fs-4 d-flex align-items-center justify-content-center h-100"></i>
            </div>
            <h5 class="text-muted mb-1">Heures attendues</h5>
            <h2 class="mb-0 fw-bold">{{ emp_data.totals.expected_hours }}</h2>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- Détail par jour -->
<div class="card mb-5">
  <div class="card-header border-1 py-3">
    <h3 class="mb-0 fw-bold">{{ emp_data.employee.name }}</h3>
  </div>
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead>
          <tr>
            <th>Date</th>
            <th>Horaires</th>
            <th class="text-end">Total</th>
            <th class="text-end">Suppl.</th>
            <th class="text-end">Retard</th>
            <th class="text-end">Départ ant.</th>
            <th>Statut</th>
          </tr>
        </thead>
        <tbody>
          {% for day in emp_data.days %}
          <tr>
            <td class="fw-semibold">{{ day.date|date:"l j F Y" }}</td>
            <td>
              {% for entry, exit in day.pairs %}
                <div class="d-inline-flex flex-column bg-light rounded-pill px-3 py-1 me-2">
                  <small class="text-muted">
                    <i class="bi bi-box-arrow-in-right me-1"></i>{{ entry|time:"H:i" }}
                  </small>
                  <small class="text-muted">
                    <i class="bi bi-box-arrow-left me-1"></i>
                    {% if exit %}{{ exit|time:"H:i" }}{% else %}-{% endif %}
                  </small>
                </div>
              {% empty %}
                <span class="text-muted">—</span>
              {% endfor %}
            </td>
            <td class="text-end fw-semibold">{{ day.total }}</td>
            <td class="text-end">{{ day.overtime }}</td>
            <td class="text-end text-danger">{{ day.late }}</td>
            <td class="text-end text-info">{{ day.early_leave }}</td>
            <td>
              {% if day.is_absent %}
                <span class="badge bg-danger bg-opacity-25 text-danger">
                  <i class="bi bi-x-circle me-1"></i>Absence
                </span>
              {% elif day.late != "-" %}
                <span class="badge bg-warning bg-opacity-25 text-warning">
                  <i class="bi bi-clock-history me-1"></i>Retard {{ day.late }}
                </span>
              {% else %}
                <span class="badge bg-success bg-opacity-25 text-success">
                  <i class="bi bi-check-circle me-1"></i>À l'heure
                </span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
  {% endfor %}