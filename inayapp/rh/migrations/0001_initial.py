# Generated by Django 5.1.7 on 2025-04-30 21:43

import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ("finance", "0002_initial"),
        ("medical", "0001_initial"),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name="AnvizConfiguration",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        blank=True, max_length=100, null=True, verbose_name="Nom"
                    ),
                ),
                (
                    "ip_address",
                    models.GenericIPAddressField(
                        protocol="IPv4", verbose_name="Adresse IP"
                    ),
                ),
                (
                    "username",
                    models.CharField(max_length=100, verbose_name="Nom d'utilisateur"),
                ),
                (
                    "password",
                    models.CharField(max_length=100, verbose_name="Mot de passe"),
                ),
                (
                    "session_timeout",
                    models.PositiveIntegerField(
                        default=1800, verbose_name="Délai de session (secondes)"
                    ),
                ),
                ("is_active", models.BooleanField(default=True, verbose_name="Actif")),
                (
                    "last_modified",
                    models.DateTimeField(
                        auto_now=True, verbose_name="Dernière modification"
                    ),
                ),
            ],
            options={
                "verbose_name": "Configuration Pointeuse",
                "verbose_name_plural": "Configuration Pointeuse",
            },
        ),
        migrations.CreateModel(
            name="Employee",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "anviz_id",
                    models.BigIntegerField(unique=True, verbose_name="ID Anviz"),
                ),
                ("name", models.CharField(max_length=100, verbose_name="Nom complet")),
                (
                    "card_number",
                    models.CharField(
                        blank=True,
                        max_length=20,
                        null=True,
                        verbose_name="Numéro de badge",
                    ),
                ),
                (
                    "department",
                    models.PositiveSmallIntegerField(
                        default=0, verbose_name="Département"
                    ),
                ),
                (
                    "group",
                    models.PositiveSmallIntegerField(default=0, verbose_name="Groupe"),
                ),
                (
                    "shift",
                    models.CharField(
                        choices=[("day", "Jour"), ("night", "Nuit"), ("24h", "24h")],
                        default="day",
                        max_length=5,
                        verbose_name="Type de shift",
                    ),
                ),
                (
                    "reference_start",
                    models.TimeField(
                        blank=True,
                        null=True,
                        verbose_name="Heure de début de référence",
                    ),
                ),
                (
                    "reference_end",
                    models.TimeField(
                        blank=True, null=True, verbose_name="Heure de fin de référence"
                    ),
                ),
                (
                    "last_updated",
                    models.DateTimeField(
                        auto_now=True, verbose_name="Dernière mise à jour"
                    ),
                ),
            ],
            options={
                "verbose_name": "Employé",
                "verbose_name_plural": "Employés",
            },
        ),
        migrations.CreateModel(
            name="HonorairesActe",
            fields=[
                ("id_acte", models.AutoField(primary_key=True, serialize=False)),
                ("name_acte", models.CharField(blank=True, max_length=50, null=True)),
                (
                    "prix_acte",
                    models.DecimalField(
                        blank=True, decimal_places=0, max_digits=10, null=True
                    ),
                ),
            ],
            options={
                "managed": True,
            },
        ),
        migrations.CreateModel(
            name="Poste",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("label", models.CharField(max_length=100)),
            ],
            options={
                "verbose_name": "Poste",
                "verbose_name_plural": "Postes",
            },
        ),
        migrations.CreateModel(
            name="Shift",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("code", models.CharField(max_length=10, unique=True)),
                ("label", models.CharField(max_length=50)),
                ("debut", models.TimeField(blank=True, null=True)),
                ("fin", models.TimeField(blank=True, null=True)),
            ],
            options={
                "verbose_name": "Shift",
                "verbose_name_plural": "Shifts",
            },
        ),
        migrations.CreateModel(
            name="Personnel",
            fields=[
                ("id_personnel", models.AutoField(primary_key=True, serialize=False)),
                ("nom_prenom", models.CharField(blank=True, max_length=100, null=True)),
                ("telephone", models.CharField(blank=True, max_length=15, null=True)),
                ("created_at", models.DateTimeField(auto_now_add=True, null=True)),
                ("updated_at", models.DateTimeField(auto_now=True, null=True)),
                ("statut_activite", models.BooleanField(default=True)),
                ("use_in_planning", models.BooleanField(default=False)),
                (
                    "service",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="personnels",
                        to="medical.service",
                    ),
                ),
                (
                    "user",
                    models.OneToOneField(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "poste",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        to="rh.poste",
                        verbose_name="Poste occupé",
                    ),
                ),
            ],
            options={
                "ordering": ["nom_prenom"],
                "managed": True,
            },
        ),
        migrations.CreateModel(
            name="LeaveRequest",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("start_date", models.DateField()),
                ("end_date", models.DateField()),
                (
                    "leave_type",
                    models.CharField(
                        choices=[
                            ("VAC", "Congé annuel"),
                            ("SIC", "Congé maladie"),
                            ("MAT", "Congé maternité"),
                            ("PAT", "Congé paternité"),
                            ("AUT", "Autre"),
                        ],
                        default="VAC",
                        max_length=3,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PEN", "En attente"),
                            ("APP", "Approuvé"),
                            ("REJ", "Rejeté"),
                            ("CAN", "Annulé"),
                        ],
                        default="PEN",
                        max_length=3,
                    ),
                ),
                ("reason", models.TextField()),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "personnel",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="leave_requests",
                        to="rh.personnel",
                    ),
                ),
            ],
            options={
                "permissions": [
                    ("process_leave_request", "Peut traiter les demandes de congé")
                ],
            },
        ),
        migrations.CreateModel(
            name="Planning",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("shift_date", models.DateField()),
                ("created_at", models.DateTimeField(auto_now_add=True, null=True)),
                (
                    "prix",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        default=0,
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "prix_acte",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        default=0,
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "paiement",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        default=0,
                        max_digits=10,
                        null=True,
                    ),
                ),
                ("pointage_created_at", models.DateTimeField(blank=True, null=True)),
                (
                    "employee",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        to="rh.personnel",
                    ),
                ),
                (
                    "id_created_par",
                    models.ForeignKey(
                        blank=True,
                        db_column="id_created_par",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="id_created_par",
                        to="rh.personnel",
                    ),
                ),
                (
                    "id_decharge",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="plannings",
                        to="finance.decharges",
                    ),
                ),
                (
                    "pointage_id_created_par",
                    models.ForeignKey(
                        blank=True,
                        db_column="pointage_id_created_par",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="pointage_id_created_par",
                        to="rh.personnel",
                    ),
                ),
                (
                    "service",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        to="medical.service",
                    ),
                ),
                (
                    "id_poste",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.DO_NOTHING, to="rh.poste"
                    ),
                ),
                (
                    "shift",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        to="rh.shift",
                        verbose_name="Shift associé",
                    ),
                ),
            ],
            options={
                "permissions": (
                    ("acces_aux_plannings", "Accès aux plannings"),
                    ("creer_planning", "Créer un planning"),
                    ("modifier_planning", "Modifier un planning"),
                    ("supprimer_planning", "Supprimer un planning"),
                    ("exporter_planning", "Exporter un planning"),
                ),
                "managed": True,
            },
        ),
        migrations.CreateModel(
            name="PointagesActes",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("nbr_actes", models.IntegerField()),
                (
                    "id_acte",
                    models.ForeignKey(
                        blank=True,
                        db_column="id_acte",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        to="rh.honorairesacte",
                    ),
                ),
                (
                    "id_planning",
                    models.ForeignKey(
                        blank=True,
                        db_column="id_planning",
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        to="rh.planning",
                    ),
                ),
            ],
            options={
                "managed": True,
            },
        ),
        migrations.AddField(
            model_name="honorairesacte",
            name="id_poste",
            field=models.ForeignKey(
                db_column="id_poste",
                default=1,
                on_delete=django.db.models.deletion.DO_NOTHING,
                to="rh.poste",
            ),
        ),
        migrations.CreateModel(
            name="SalaryAdvanceRequest",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("amount", models.DecimalField(decimal_places=2, max_digits=10)),
                ("request_date", models.DateField(default=django.utils.timezone.now)),
                ("payment_date", models.DateField()),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PEN", "En attente"),
                            ("APP", "Approuvée"),
                            ("REJ", "Rejetée"),
                            ("CAN", "Annulée"),
                        ],
                        default="PEN",
                        max_length=3,
                    ),
                ),
                ("reason", models.TextField(blank=True, null=True)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "personnel",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="salary_advances",
                        to="rh.personnel",
                    ),
                ),
            ],
            options={
                "permissions": [
                    (
                        "process_salaryadvance_request",
                        "Peut traiter les demandes d'avance sur salaire",
                    )
                ],
            },
        ),
        migrations.CreateModel(
            name="Attendance",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("check_time", models.DateTimeField(verbose_name="Heure de pointage")),
                (
                    "check_type",
                    models.CharField(
                        choices=[
                            ("IN", "Entrée"),
                            ("OUT", "Sortie"),
                            ("2", "Début pause"),
                            ("3", "Fin pause"),
                            ("4", "Heure supplémentaire"),
                            ("5", "Retard"),
                            ("6", "Absence"),
                        ],
                        max_length=6,
                        verbose_name="Type de pointage",
                    ),
                ),
                (
                    "synced_at",
                    models.DateTimeField(
                        auto_now_add=True, verbose_name="Date de synchronisation"
                    ),
                ),
                (
                    "employee",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="attendances",
                        to="rh.employee",
                        verbose_name="Employé",
                    ),
                ),
            ],
            options={
                "verbose_name": "Pointage",
                "verbose_name_plural": "Pointages",
                "indexes": [
                    models.Index(
                        fields=["check_time"], name="rh_attendan_check_t_0de09e_idx"
                    ),
                    models.Index(
                        fields=["employee", "check_time"],
                        name="rh_attendan_employe_989d3f_idx",
                    ),
                ],
                "unique_together": {("employee", "check_time")},
            },
        ),
    ]
